#Questions::

#1. What are the details of all cars purchased in the year 2022?
select cars.car_id,cars.make,cars.type,cars.style,cars.cost_$ ,sales.purchase_date from cars
inner join sales
on
cars.car_id=sales.car_id
where year(purchase_date)=2022;

#2. What is the total number of cars sold by each salesperson?
select sales.salesman_id, name , count(sale_id)   from sales
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id
group by sales.salesman_id;


#3. What is the total revenue generated by each salesperson?
select sales.sale_id, sum(cost_$)  , name from sales
inner join cars
on
sales.sale_id=cars.car_id
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id
group by sales.sale_id;



#3. What is the total revenue generated by each salesperson?
select sales.salesman_id,sum(cost_$) , name from sales
inner join cars
on
sales.car_id=cars.car_id
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id
group by sales.salesman_id;


#4. What are the details of the cars sold by each salesperson?
select sales.salesman_id,salespersons.name,cars.car_id,cars.make,cars.type,cars.style,cars.cost_$ from cars
inner join sales
on
cars.car_id=sales.car_id
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id;
 
 
#5. What is the total revenue generated by each car type?
select type , sum(cost_$) as total_revenue , sales.car_id  from cars
inner join sales
on
cars.car_id=sales.car_id
group by car_id;

#6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
select cars.make,cars.type,cars.style,cars.cost_$, sales.car_id,sales.purchase_date , salespersons.name from cars
inner join 
sales
on
cars.car_id=sales.car_id
inner join 
salespersons
on
sales.salesman_id=salespersons.salesman_id
where salespersons.name="emily wong" and year(purchase_date)=2021;


#7. What is the total revenue generated by the sales of hatchback cars?
select cars.style , sum(cost_$) , sales.car_id from cars
inner join sales
on
cars.car_id=sales.car_id
where cars.style="hatchback"
group by cars.style , sales.car_id;


#8. What is the total revenue generated by the sales of SUV cars in the year 2022?
select cars.style , sum(cars.cost_$) from cars
inner join sales
on
cars.car_id=sales.car_id
where style="suv" and year(purchase_date)="2022"
group by cars.style;


#9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
select    sales.salesman_id,salespersons.name,salespersons.city , count(sales.sale_id) as Total_cars_sold  from sales
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id
where  year(purchase_date)="2023"
group by sales.salesman_id,salespersons.name,salespersons.city
order by Total_cars_sold desc
limit 1;


#10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?
select     salespersons.name,salespersons.age , sum(cost_$) as Highest_revenue from cars
inner join sales
on
cars.car_id=sales.car_id
inner join salespersons
on
sales.salesman_id=salespersons.salesman_id
where year(purchase_date)=2022
group by  salespersons.name,salespersons.age
order by Highest_revenue desc
limit 1;
